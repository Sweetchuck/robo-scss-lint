
cache:
    directories:
        - '$HOME/.composer/cache'
        - '$HOME/.rvm'

matrix:
    fast_finish: true
    include:
        -
            os: 'linux'
            dist: 'trusty'
            sudo: false
            language: 'php'
            php: '7.1'
            env:
                - "COMPOSER_NO_INTERACTION=1 COMPOSER_DISABLE_XDEBUG_WARN=1 RUBY_VERSION=$(bundle platform --ruby | awk '{print $2}')"
        -
            os: 'osx'
            language: 'generic'
            env:
                - "COMPOSER_NO_INTERACTION=1 COMPOSER_DISABLE_XDEBUG_WARN=1 RUBY_VERSION=$(bundle platform --ruby | awk '{print $2}') _PHP=php71"

before_install:
    - 'src-dev/scripts/travis/before_install.sh'

install:
    - 'rvm install "${RUBY_VERSION}"'
    - 'gem install bundler'
    - 'bundle check || bundle install'
    - 'composer install'

script:
    - './bin/robo --ansi lint'
    - './bin/robo --ansi test'

after_success:
    - 'bash <(curl -s https://codecov.io/bash)'

notifications:
    email: false
